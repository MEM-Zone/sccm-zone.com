<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="/common/favicon.ico">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/common/site.css">
    
    
    <title>SCCM Zone :: Add computers from a file to a SCCM Collection using PowerShell and System File Watcher</title>
    <meta property="og:title"       content="SCCM Zone :: Add computers from a file to a SCCM Collection using PowerShell and System File Watcher" />
    <meta property="og:type"        content="article" />
    
    <meta property="og:url"         content="https://sccm-zone.com/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/" />
    <meta property="og:description" content="" />
    
    
    
    
    
    
    
    
    
    
    <meta name="twitter:card"       content="summary" />
    
    
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark bg-dark">
      
      <ul class="navbar-nav">
        
        
        
        
      </ul>
    </header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://sccm-zone.com">SCCM Zone</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expand="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar_nav">
        
        <ul class="navbar-nav mr-auto">
          
          
          
          <li class="nav-item">
            <span class="nav-link disabled">Created At: 2017.02.05</span>
          </li>
          <li class="nav-item">
            <span class="nav-link disabled">Updated At: 2019.08.23</span>
          </li>
          
        </ul>
        
        <div class="navbar-nav ml-auto">
          <span class="navbar-text mr-1">share this page via</span>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/share?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher%2f&text=Add%20computers%20from%20a%20file%20to%20a%20SCCM%20Collection%20using%20PowerShell%20and%20System%20File%20Watcher" target="_blank"><i class="fab fa-twitter"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher%2f" target="_blank"><i class="fab fa-facebook"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher%2f&title=Add%20computers%20from%20a%20file%20to%20a%20SCCM%20Collection%20using%20PowerShell%20and%20System%20File%20Watcher" target="_blank"><i class="fab fa-linkedin"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://plusone.google.com/_/+1/confirm?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher%2f" target="_blank"><i class="fab fa-google-plus"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://b.hatena.ne.jp/entry/https://sccm-zone.com/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/" target="_blank">b!</a>
            </li>
          </ul>
        </div>
        
      </div>
    </nav>
    <main role="main" class="container-fluid col-lg-10 offset-lg-1">

<div class="row">
  <div class="col-lg-9">
    <article>
      <div class="row">
        <h1>Add computers from a file to a SCCM Collection using PowerShell and System File Watcher</h1>
      </div>
      

<p><img src="/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/images/1.jpeg" alt="image" /></p>

<p>Add computers from a file to a collection just by saving‚Ä¶</p>

<p><a href="https://SCCM.Zone/Add-CMDeviceDirectMemebershipRules-CHANGELOG"><strong><em>Script release history</em></strong></a></p>

<p>T<br />
he script will use two CSV files containing mail notification settings and computer names. Collection direct membership rules are removed before adding new computers. Feel free to adjust the templates and script provided bellow to suit your needs.</p>

<h3 id="script">Script</h3>

<h4 id="membership-rules-configuration-file-parameters">Membership rules configuration file parameters</h4>

<ul>
<li>**DeviceName<br />
<strong><em>Computer name (</em></strong><em>NetBios Name</em>**<em>).</em><br /></li>
<li>**CollectionName<br />
<strong><em>Maintenance windows collection (</em></strong><em>Collection Name</em>**<em>).</em><br />
<br /></li>
</ul>

<h4 id="mail-configuration-file-parameters">Mail configuration file parameters</h4>

<ul>
<li>**SendMail<br />
<strong><em>Specifies to send mail after the script is run (</em></strong><em>Yes/No</em>**<em>).</em><br /></li>
<li>**From<br />
<strong><em>Specifies mail sender to impersonate (</em></strong><em>SCCM &lt;noreply@test.com&gt;</em>**<em>).</em><br /></li>
<li>**To<br />
<strong><em>Specifies send mail to address (&lt;</em></strong><em>sccm-team@test.com&gt;</em>**<em>).</em><br /></li>
<li>**CC<br />
<strong><em>Specifies carbon copy address (&lt;</em></strong><em>No&gt;/&lt;test@test.com&gt;</em>**<em>).</em><br /></li>
<li>**SMTPServer<br />
<strong><em>Specifies the SMTP enabled server FQDN (&lt;</em></strong><em>mail.test.com&gt;</em>**<em>).</em><br /></li>
<li>**SMTPPort<br />
<strong><em>Specifies the SMTP server port (&lt;</em></strong><em>25&gt;</em>**<em>)</em>.&gt; **Notes<br />
&gt; **You can add this script to task scheduler and run it on system startup.<br />
&gt; The Add-CMDeviceDirectMemebership.csv must reside on local file storage in order for SystemFileWatcher to work.<br />
&gt; Existing collection direct membership rules are removed prior to adding new collection members.<br />
<br />
<br />
<br /></li>
</ul>

<h4 id="configuration-files-template">Configuration files template</h4>

<p>Membership rules configuration file</p>

<p>Mail configuration file</p>

<p><img src="/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/images/2.jpeg" alt="image" /></p>

<blockquote>
<p>Use <a href="https://SCCM.Zone/Issues">Github</a> for üêõ reporting, or üåà andü¶Ñ requests</p>
</blockquote>

<h4 id="please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</h4>

<p><img src="/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/images/3.gif" alt="image" /></p>

    </article>
  </div>
  <div class="col-lg-3">
    <div class="sidebar">
  
  <hr />
  <h4>TableOfContents</h4>
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#script">Script</a>
<ul>
<li><a href="#membership-rules-configuration-file-parameters">Membership rules configuration file parameters</a></li>
<li><a href="#mail-configuration-file-parameters">Mail configuration file parameters</a></li>
<li><a href="#configuration-files-template">Configuration files template</a></li>
<li><a href="#please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  <hr />
  <h4><a href="/categories/">Categories</a></h4>
  
  <hr />
  <h4><a href="/tags/">Tags</a></h4>
  
</div>

  </div>
</div>
      <div class="row">
        <footer class="col-lg-12">
          <hr/>
          <span>&copy; SCCM Zone</span>
          <span>&nbsp;&middot;&nbsp;</span>
          <i class="fas fa-bolt"></i>
          <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
        </footer>
      </div>
    </div>
    </main>
    
      
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </body>
</html>

