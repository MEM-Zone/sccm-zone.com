<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="/common/favicon.ico">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/common/site.css">
    
    
    <title>SCCM Zone :: SQL Version Detection and Reporting with SCCM</title>
    <meta property="og:title"       content="SCCM Zone :: SQL Version Detection and Reporting with SCCM" />
    <meta property="og:type"        content="article" />
    
    <meta property="og:url"         content="https://sccm-zone.com/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/" />
    <meta property="og:description" content="" />
    
    
    
    
    
    
    
    
    
    
    <meta name="twitter:card"       content="summary" />
    
    
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark bg-dark">
      
      <ul class="navbar-nav">
        
        
        
        
      </ul>
    </header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://sccm-zone.com">SCCM Zone</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expand="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar_nav">
        
        <ul class="navbar-nav mr-auto">
          
          
          
          <li class="nav-item">
            <span class="nav-link disabled">Created At: 2016.02.08</span>
          </li>
          <li class="nav-item">
            <span class="nav-link disabled">Updated At: 2019.08.23</span>
          </li>
          
        </ul>
        
        <div class="navbar-nav ml-auto">
          <span class="navbar-text mr-1">share this page via</span>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/share?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-02-08_sql-version-detection-and-reporting-with-sccm%2f&text=SQL%20Version%20Detection%20and%20Reporting%20with%20SCCM" target="_blank"><i class="fab fa-twitter"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-02-08_sql-version-detection-and-reporting-with-sccm%2f" target="_blank"><i class="fab fa-facebook"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-02-08_sql-version-detection-and-reporting-with-sccm%2f&title=SQL%20Version%20Detection%20and%20Reporting%20with%20SCCM" target="_blank"><i class="fab fa-linkedin"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://plusone.google.com/_/+1/confirm?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-02-08_sql-version-detection-and-reporting-with-sccm%2f" target="_blank"><i class="fab fa-google-plus"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://b.hatena.ne.jp/entry/https://sccm-zone.com/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/" target="_blank">b!</a>
            </li>
          </ul>
        </div>
        
      </div>
    </nav>
    <main role="main" class="container-fluid col-lg-10 offset-lg-1">

<div class="row">
  <div class="col-lg-9">
    <article>
      <div class="row">
        <h1>SQL Version Detection and Reporting with SCCM</h1>
      </div>
      

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/1.jpeg" alt="image" /></p>

<p>SQL version reporting with SCCM done right…</p>

<p><a href="https://SCCM.Zone/SW-SQL-Server-Products"><strong><em>New version here</em></strong></a></p>

<p>By<br />
 default, the SQL information that can be gathered with SCCM is incomplete. The version, service pack and cumulative update information are available in WMI, but are not stored in the cimv2 namespace. In order to be able to gather the relevant SQL information, a hardware inventory extension is required.<br />
&gt; <strong>Notes</strong>&gt; <strong>ALWAYS BACK-UP YOUR CONFIGURATION.MOF FILE BEFORE ANY CHANGES!<br />
&gt; TEST THE CONFIGURATION.MOF USING MOFCOMP.EXE ON A TEST MACHINE FIRST!<br />
&gt; HWI EXTENSION NEEDS TO BE DONE ON THE TOP OF YOUR HIERARCHY, CAS IF YOU USE ONE, PSS IF YOU DON’T.</strong></p>

<h3 id="add-sql-extensions-to-the-configuration-mof-file">Add SQL extensions to the Configuration.mof file</h3>

<p>You can find the the <a href="https://technet.microsoft.com/en-us/library/bb680858.aspx"><strong><em>Configuration.mof</em></strong></a> file in <strong>_&lt;CMInstallLocation&gt;\Inboxes\clifiles.src\hinv_</strong></p>

<p>Look for the following section at the end of the <em>Configuration.mof</em> file:<br />
<code>//========================  
// Added extensions start   
//========================</code><code>//========================  
// Added extensions end   
//========================</code></p>

<p>Inside this section paste the following extension:</p>

<h4 id="sql-information-extension">SQL Information extension</h4>

<p>SCCM HWI Extension for SQL Version Detection to paste in the <strong>Configuration.mof</strong> file</p>

<blockquote>
<p><strong>Notes</strong><br />
Never create any extensions outside of the “Added extensions start/end” headers.<br />
Try to have consistent formatting inside these headers.<br />
Never modify anything outside these headers.<br />
Watch for other previous extensions and use clear delimitation between them.</p>
</blockquote>

<h3 id="add-custom-classes-to-hardware-inventory">Add Custom Classes to Hardware Inventory</h3>

<h4 id="sql-information-definitions">SQL Information Definitions</h4>

<p>Code posted only for reference, you can download the file below.</p>

<p>Code posted just for reference, you can download the file below</p>

<h3 id="test-and-implement-hwi-extension">Test and Implement HWI extension</h3>

<p>Use <a href="http://mofcomp.exe%20configuration.mof"><strong><em>mofcomp.exe</em></strong></a>** __ **to check if configuration.mof was correctly modified, and implement the changes.</p>

<p><strong>Compiling the configuration.mof file in the hinv folder on the CAS/PSS, will trigger the distribution and compilation on all machines in your environment.</strong></p>

<p>Either use a test environment or compile the file on a test machine first. After the file complies successfully you can check the WMI to see if the classes were created.</p>

<h4 id="compile-configuration-mof">Compile configuration.mof</h4>

<p><code>**## Check syntax**  
mofcomp.exe -check {Configuration.mof Location}\Configuration.mof</code><code>**## Compile file**   
/*   
Compiling the configuration.mof file in the hinv folder on the CAS/PSS, will trigger the distribution and compilation on all machines in your environment.  
*/</code><code>mofcomp.exe {Configuration.mof Location}\Configuration.mof</code></p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/2.png" alt="image" /></p>

<p>Compling the configuration.mof is done on a test environment here</p>

<h4 id="check-wmi-for-the-new-classes">Check WMI for the new classes</h4>

<p><code>**## Check if the new classes are present in WMI** /* The machine must have at least one version of SQL installed in order for these classes to be created */</code><code>**#  Get SQL 2017 class**  
Get-CimClass -ClassName SQL_2017</code><code>**#  Get SQL 2014 class**  
Get-CimClass -ClassName SQL_2014</code><code>**#  Get SQL 2012 class**  
Get-CimClass -ClassName SQL_2012</code><code>**#  Get SQL 2008 class**  
Get-CimClass -ClassName SQL_2008</code><code>**#  Get SQL Legacy class**  
Get-CimClass -ClassName SQL_2000_And_2005</code></p>

<h3 id="implement-changes-on-the-cas-pss">Implement changes on the CAS/PSS</h3>

<h4 id="compile-the-configuration-mof-file">Compile the configuration.mof file</h4>

<p><code>**## Compile file** /*   
Compiling the configuration.mof file in the hinv folder on the CAS/PSS, will trigger the distribution and compilation on all machines in your environment.  
*/</code><code>mofcomp.exe &amp;lt;CMInstallLocation&amp;gt;\Inboxes\clifiles.src\hinv\Configuration.mof</code></p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/3.png" alt="image" /></p>

<p>Implement HWI extension in production</p>

<h4 id="import-the-new-hwi-definitions">Import the new HWI definitions</h4>

<p>You need to add the new class definitions to the Default Client Settings.</p>

<p><strong>Download Definitions</strong><br />
<code>**## SQL classes definition file**  
[_HWI DEF SQL Classes.mof_](https://raw.githubusercontent.com/SCCM-Zone/sccm-zone.github.io/6981a6523957fd5e288ebd959b84a0fc4df71ce5/Reporting/Software/SW%20SQL%20Server%20Products/HWI%20DEF%20SQL%20Classes.mof)</code></p>

<p><strong>Import definitions</strong></p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/4.jpeg" alt="image" /></p>

<p>Click on Import and select the <strong><em>HWI DEF SQL Classes.mof</em></strong> file</p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/5.jpeg" alt="image" /></p>

<p>Review the classes and click on Import</p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/6.jpeg" alt="image" /></p>

<p>Make sure the SQL Classes are enabled and click OK</p>

<h3 id="import-the-ssrs-report">Import the SSRS Report</h3>

<h4 id="download-the-report-file">Download the report file</h4>

<p><code>**## SQL version information report (**[**Octavian Cordos**](https://medium.com/u/ab05c8e0143f)**)**  
[_SW SQL Server Products.sql_](https://raw.githubusercontent.com/SCCM-Zone/sccm-zone.github.io/6981a6523957fd5e288ebd959b84a0fc4df71ce5/Reporting/Software/SW%20SQL%20Server%20Products/SW%20SQL%20Server%20Products.rdl)</code></p>

<h4 id="upload-reports-to-ssrs">Upload reports to SSRS</h4>

<ul>
<li>Start Internet Explorer and navigate to <a href="http://en.wikipedia.org/wiki/Fully_qualified_domain_name"><strong>_http://YOUR_REPORT_SERVER<em>FQDN/Reports</em></strong></a><br /></li>
<li>Choose a path and upload the previously downloaded report file.<br />
<br /></li>
</ul>

<h4 id="configure-imported-reports">Configure imported reports</h4>

<ul>
<li><a href="https://joshheffner.com/how-to-import-additional-software-update-reports-in-sccm/"><strong><em>Replace the DataSource</em></strong></a> in the reports.&gt; <strong>Notes</strong> Allow some time for the policy to be downloaded of force a policy refresh to get the new WMI classes.<br />
&gt; Allow some time for the data to be gathered or force a HWI collection.<br />
&gt; This report was created with SQL 2014 Reporting Services, you might need to remove some report elements if you use an older version.<br />
<br /></li>
</ul>

<h4 id="report-query">Report Query</h4>

<p>For reference only, since the report includes this query.</p>

<p>Report query posted just for reference, you can download the <strong>Report</strong> above.</p>

<h4 id="report-preview">Report Preview</h4>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/7.jpeg" alt="image" /></p>

<p>Report preview</p>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/8.jpeg" alt="image" /></p>

<h4 id="please-subscribe-and-clap-for-this-article-it-makes-a-difference-thanks"><strong>Please, Subscribe and Clap for this article! It makes a difference. Thanks!</strong></h4>

<p><img src="/posts/2016-02-08_sql-version-detection-and-reporting-with-sccm/images/9.gif" alt="image" /></p>

<blockquote>
<p>Use <a href="http://SCCM.Zone/GIT">Github</a> for 🐛 reporting, or 🌈 and🦄 requests</p>
</blockquote>

    </article>
  </div>
  <div class="col-lg-3">
    <div class="sidebar">
  
  <hr />
  <h4>TableOfContents</h4>
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#add-sql-extensions-to-the-configuration-mof-file">Add SQL extensions to the Configuration.mof file</a>
<ul>
<li><a href="#sql-information-extension">SQL Information extension</a></li>
</ul></li>
<li><a href="#add-custom-classes-to-hardware-inventory">Add Custom Classes to Hardware Inventory</a>
<ul>
<li><a href="#sql-information-definitions">SQL Information Definitions</a></li>
</ul></li>
<li><a href="#test-and-implement-hwi-extension">Test and Implement HWI extension</a>
<ul>
<li><a href="#compile-configuration-mof">Compile configuration.mof</a></li>
<li><a href="#check-wmi-for-the-new-classes">Check WMI for the new classes</a></li>
</ul></li>
<li><a href="#implement-changes-on-the-cas-pss">Implement changes on the CAS/PSS</a>
<ul>
<li><a href="#compile-the-configuration-mof-file">Compile the configuration.mof file</a></li>
<li><a href="#import-the-new-hwi-definitions">Import the new HWI definitions</a></li>
</ul></li>
<li><a href="#import-the-ssrs-report">Import the SSRS Report</a>
<ul>
<li><a href="#download-the-report-file">Download the report file</a></li>
<li><a href="#upload-reports-to-ssrs">Upload reports to SSRS</a></li>
<li><a href="#configure-imported-reports">Configure imported reports</a></li>
<li><a href="#report-query">Report Query</a></li>
<li><a href="#report-preview">Report Preview</a></li>
<li><a href="#please-subscribe-and-clap-for-this-article-it-makes-a-difference-thanks"><strong>Please, Subscribe and Clap for this article! It makes a difference. Thanks!</strong></a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  <hr />
  <h4><a href="/categories/">Categories</a></h4>
  
  <hr />
  <h4><a href="/tags/">Tags</a></h4>
  
</div>

  </div>
</div>
      <div class="row">
        <footer class="col-lg-12">
          <hr/>
          <span>&copy; SCCM Zone</span>
          <span>&nbsp;&middot;&nbsp;</span>
          <i class="fas fa-bolt"></i>
          <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
        </footer>
      </div>
    </div>
    </main>
    
      
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </body>
</html>

