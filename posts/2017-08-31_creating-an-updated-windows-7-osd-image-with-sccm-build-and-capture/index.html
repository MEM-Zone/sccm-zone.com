<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="/common/favicon.ico">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/common/site.css">
    
    
    <title>SCCM Zone :: Creating an Updated Windows 7 OSD Image with SCCM Build and Capture</title>
    <meta property="og:title"       content="SCCM Zone :: Creating an Updated Windows 7 OSD Image with SCCM Build and Capture" />
    <meta property="og:type"        content="article" />
    
    <meta property="og:url"         content="https://sccm-zone.com/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/" />
    <meta property="og:description" content="" />
    
    
    
    
    
    
    
    
    
    
    <meta name="twitter:card"       content="summary" />
    
    
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark bg-dark">
      
      <ul class="navbar-nav">
        
        
        
        
      </ul>
    </header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://sccm-zone.com">SCCM Zone</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expand="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar_nav">
        
        <ul class="navbar-nav mr-auto">
          
          
          
          <li class="nav-item">
            <span class="nav-link disabled">Created At: 2017.08.31</span>
          </li>
          <li class="nav-item">
            <span class="nav-link disabled">Updated At: 2019.08.23</span>
          </li>
          
        </ul>
        
        <div class="navbar-nav ml-auto">
          <span class="navbar-text mr-1">share this page via</span>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/share?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture%2f&text=Creating%20an%20Updated%20Windows%207%20OSD%20Image%20with%20SCCM%20Build%20and%20Capture" target="_blank"><i class="fab fa-twitter"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture%2f" target="_blank"><i class="fab fa-facebook"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture%2f&title=Creating%20an%20Updated%20Windows%207%20OSD%20Image%20with%20SCCM%20Build%20and%20Capture" target="_blank"><i class="fab fa-linkedin"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://plusone.google.com/_/+1/confirm?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture%2f" target="_blank"><i class="fab fa-google-plus"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://b.hatena.ne.jp/entry/https://sccm-zone.com/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/" target="_blank">b!</a>
            </li>
          </ul>
        </div>
        
      </div>
    </nav>
    <main role="main" class="container-fluid col-lg-10 offset-lg-1">

<div class="row">
  <div class="col-lg-9">
    <article>
      <div class="row">
        <h1>Creating an Updated Windows 7 OSD Image with SCCM Build and Capture</h1>
      </div>
      

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/1.png" alt="image" /></p>

<p>Creating a OSD Image can be a hassle but with a bit of automation you can drop a lot of overhead</p>

<p>T<br />
he recommendation is to use MDT for creating your OSD Image, but I achieved the same results using SCCM.</p>

<p>Here I‚Äôm using Windows 7 with Office 2010, but the process is similar for every OS and Office Version.</p>

<h3 id="image-specs">Image specs</h3>

<h4 id="injected-in-the-base-image">Injected in the Base Image</h4>

<ul>
<li>Windows 7, fully updated<br /></li>
<li>Internet Explorer 11<br />
<br /></li>
</ul>

<h4 id="installed-during-build-and-capture">Installed during Build and Capture</h4>

<ul>
<li>Office 2010, fully updated<br /></li>
<li>.Net Framework 4.7<br /></li>
<li>WMF 5.1<br /></li>
<li>Redistributables<br />
<br /></li>
</ul>

<h3 id="important-things-to-remember-when-creating-a-osd-image">Important things to remember when creating a OSD Image</h3>

<ul>
<li>ALWAYS use a Vanilla WIM for your BASE Image. The BASE Image consists of a Vanilla WIM updated using Offline Servicing.<br /></li>
<li>IMPORT the WIM from the latest version of the OS Image downloaded from MSDN. Deploying the MSDN image and using the captured version is not the proper procedure.<br /></li>
<li>USE Offline Servicing only on your BASE Image. Offline Servicing your OSD Image is easier but it can get you in a lot of trouble.<br /></li>
<li>DO B&amp;C every month for all OSD Images after performing Offline Servicing on the BASE Images.<br /></li>
<li>INCLUDE your core applications in the OSD Image. The OSD Image is the final image used by the Customer for OSD. This will shorten de deployment time, and reduce the complexity of the OSD Task Sequence. Remember not to go overboard with it though.<br /></li>
<li>INCLUDE Office Updates in the OSD Image. Office 2010 has a ton of updates and no recent service pack, so including them saves time during OSD.<br />
<br /></li>
</ul>

<h3 id="step-1-download-patches">Step 1‚Ää‚Äî‚ÄäDownload Patches</h3>

<h4 id="download-ie11-and-prerequisites-https-support-microsoft-com-en-us-help-2847882-prerequisite-updates-for-internet-explorer-11"><a href="https://support.microsoft.com/en-us/help/2847882/prerequisite-updates-for-internet-explorer-11"><strong>Download IE11 and prerequisites</strong></a></h4>

<ul>
<li>**x86<br />
**<a href="https://download.microsoft.com/download/B/6/B/B6BF1D9B-2568-406B-88E8-E4A218DEA90A/Windows6.1-KB2729094-v2-x86.msu"><em>Windows6.1-KB2729094-v2-x86.msu</em></a>_<br />
<em><a href="https://download.microsoft.com/download/A/0/B/A0BA0A59-1F11-4736-91C0-DFCB06224D99/Windows6.1-KB2731771-x86.msu"><em>Windows6.1-KB2731771-x86.msu</em></a>_<br />
_<a href="https://download.microsoft.com/download/2/D/7/2D78D0DD-2802-41F5-88D6-DC1D559F206D/Windows6.1-KB2533623-x86.msu"><em>Windows6.1-KB2533623-x86.msu</em></a></em><br />
<em><a href="https://download.microsoft.com/download/1/4/9/14936FE9-4D16-4019-A093-5E00182609EB/Windows6.1-KB2670838-x86.msu"><em>Windows6.1-KB2670838-x86.msu</em></a>_<br />
_<a href="https://download.microsoft.com/download/4/8/1/481C640E-D3EE-4ADC-AA48-6D0ED2869D37/Windows6.1-KB2786081-x86.msu"><em>Windows6.1-KB2786081-x86.msu</em></a></em><br />
_<a href="https://download.microsoft.com/download/F/1/4/F1424AD7-F754-4B6E-B0DA-151C7CBAE859/Windows6.1-KB2834140-v2-x86.msu"><em>Windows6.1-KB2834140-v2-x86.msu</em></a>_<br />
_<a href="http://download.microsoft.com/download/C/0/1/C0186BE0-0ADB-4AF3-B97D-11FCEBE6BD68/IE11-Windows6.1-KB2841134-x86.cab"><em>IE11-Windows6.1-KB2841134-x86.cab</em></a><br /></li>
<li>**x64<br />
**<a href="http://download.microsoft.com/download/6/C/A/6CA15546-A46C-4333-B405-AB18785ABB66/Windows6.1-KB2729094-v2-x64.msu"><em>Windows6.1-KB2729094-v2-x64.msu</em></a>_<br />
<em><a href="http://download.microsoft.com/download/9/F/E/9FE868F6-A0E1-4F46-96E5-87D7B6573356/Windows6.1-KB2731771-x64.msu"><em>Windows6.1-KB2731771-x64.msu</em></a>_<br />
_<a href="http://download.microsoft.com/download/F/1/0/F106E158-89A1-41E3-A9B5-32FEB2A99A0B/Windows6.1-KB2533623-x64.msu"><em>Windows6.1-KB2533623-x64.msu</em></a></em><br />
<em><a href="http://download.microsoft.com/download/1/4/9/14936FE9-4D16-4019-A093-5E00182609EB/Windows6.1-KB2670838-x64.msu"><em>Windows6.1-KB2670838-x64.msu</em></a>_<br />
_<a href="http://download.microsoft.com/download/1/8/F/18F9AE2C-4A10-417A-8408-C205420C22C3/Windows6.1-KB2786081-x64.msu"><em>Windows6.1-KB2786081-x64.msu</em></a></em><br />
_<a href="http://download.microsoft.com/download/5/A/5/5A548BFE-ADC5-414B-B6BD-E1EC27A8DD80/Windows6.1-KB2834140-v2-x64.msu"><em>Windows6.1-KB2834140-v2-x64.msu</em></a>_<br />
_<a href="http://download.microsoft.com/download/C/0/1/C0186BE0-0ADB-4AF3-B97D-11FCEBE6BD68/IE11-Windows6.1-KB2841134-x64.cab"><em>IE11-Windows6.1-KB2841134-x64.cab</em></a>&gt; <strong>Notes</strong><br />
&gt; Check if the downloaded files are not corrupted. (Size biger than 2kb)<br />
<br /></li>
</ul>

<h4 id="download-support-for-future-updates"><strong>Download Support for Future Updates</strong></h4>

<ul>
<li>**x86<br />
**<a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=46827"><em>Windows6.1-kb3020369-x86.msu</em></a>_<br />
_<a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=53335"><em>Windows6.1-kb3172605-x86.msu</em></a><br /></li>
<li>**x64<br />
**<a href="https://download.microsoft.com/download/5/D/0/5D0821EB-A92D-4CA2-9020-EC41D56B074F/Windows6.1-KB3020369-x64.msu"><em>Windows6.1-kb3020369-x64.msu</em></a>_<br />
_<a href="https://download.microsoft.com/download/5/6/0/560504D4-F91A-4DEB-867F-C713F7821374/Windows6.1-KB3172605-x64.msu"><em>Windows6.1-kb3172605-x64.msu</em></a><br />
<br /></li>
</ul>

<h4 id="download-office-2010-sp2"><strong>Download Office 2010 SP2</strong></h4>

<ul>
<li>**x86<br />
**<a href="https://download.microsoft.com/download/4/9/9/499A1B0D-6FF3-466E-888E-DC7D7C788A61/officesp2010-kb2687455-fullfile-x86-en-us.exe">officesp2010-kb2687455-fullfile-x86-en-us.exe</a><br />
<br /></li>
</ul>

<h3 id="step-2-inject-ie11-and-prerequisites">Step 2‚Äî Inject IE11 and prerequisites</h3>

<ul>
<li>Follow the instructions in my <a href="https://SCCM.Zone/update-offlinewindowsimage"><em>Add packages to a Windows Image using DISM PowerShell commandlets</em></a> post to inject IE11.<br />
<br /></li>
</ul>

<h3 id="step-3-import-the-wim-images">Step 3‚Äî Import the WIM images</h3>

<ul>
<li>Add the vanilla install.wim images to the Operating System Images. We won‚Äôt modify these images the are used only for reference (Optional).<br />
<br />
<br />
<br /></li>
</ul>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/2.png" alt="image" /></p>

<p>Reference Vanilla Images</p>

<ul>
<li>Add the previously serviced images to the Operating System Images. We will modify these images by injecting updates.<br />
<br />
<br />
<br /></li>
</ul>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/3.png" alt="image" /></p>

<p>Base Images</p>

<h3 id="step-4-download-the-updates-for-windows-7">Step‚Ää‚Äî‚Ää4 Download the updates for Windows 7</h3>

<p>If you don‚Äôt have a properly configured update system this is a <strong>must</strong>!<br />
You need to download the updates for Windows 7 in a temporary package, selecting <strong><em>‚ÄúALL LANGUAGES‚Äù</em></strong>. The package does not need to be pushed to a distribution point, you can create a dummy **<em>‚ÄúDistribution Point Group‚Äù</em> **without any members.</p>

<h4 id="download-updates-in-a-package"><strong>Download updates in a package</strong></h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/4.png" alt="image" /></p>

<p>If you don‚Äôt have properly configured update system you might need to do this</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/5.png" alt="image" /></p>

<p>Temporary Deployment Package</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/6.png" alt="image" /></p>

<p>Select all languages. I know it‚Äôs stupid but trust me on this‚Ä¶</p>

<p>**Why <em>‚ÄúAll Languages‚Äù</em>?<br />
**Because otherwise you might get the <strong><em>‚ÄúContent not found in library error‚Äù</em></strong> in your log when trying to service the image.</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/7.png" alt="image" /></p>

<p>Content not found error</p>

<p><code>--# Get Content ID Query #--  
SELECT *   
FROM dbo.v_UpdateCIs   
WHERE CI_UniqueID LIKE &amp;#39;[YourContentID]&amp;#39;</code></p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/8.png" alt="image" /></p>

<p>Get Content ID Query result</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/9.png" alt="image" /></p>

<p>WTF Korean Language? I don‚Äôt have that deployed!</p>

<blockquote>
<p><strong>Notes</strong><br />
If you still get this error after downloading all languages try downloading them again in a different package. SCCM sometimes returns success but the package is not actually downloaded (True story :). The package where the content is downloaded doesn‚Äôt actually matter, after the files are picked up by SCCM SIS they will e available no matter which package is storing them.</p>
</blockquote>

<h3 id="step-5-offline-servicing">Step‚Ää‚Äî‚Ää5 Offline Servicing</h3>

<p>You can now service the images with select** <em>‚ÄúSchedule Updates‚Äù</em>**_. S_elect all and then exclude the **<em>‚ÄúPreview‚Äù</em> <strong>and ‚Äú</strong><em>Security Only‚Äù</em>** updates.</p>

<ul>
<li><strong><em>‚ÄúPreview‚Äù</em></strong> because these updates are updates for the next month.<br /></li>
<li>‚Äú<strong><em>Security Only‚Äù</em></strong> because the **<em>‚ÄúQuality Rollups‚Äù</em> <strong>include</strong> __ **the <strong>‚Äú<em>Security Only‚Äù</em></strong> updates.<br />
<br /></li>
</ul>

<p>You can include all updates If you want to though.</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/10.png" alt="image" /></p>

<p>I‚Äôm only showing only 4 updates, because my image is already serviced</p>

<h4 id="problems-you-might-encounter">Problems you might encounter</h4>

<ul>
<li>**Error: Not all selected software updates are currently available on current site<br />
**You probably downloaded the uptades in a package for a different site, see Step 4.<br />
<br />
<br />
<br /></li>
</ul>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/11.png" alt="image" /></p>

<p>Packages need to be stored on the site which is servicing the image, see step 4 :)</p>

<ul>
<li>**Error: InstallUpdate returned code 0x800f082f~<br />
**Use the <a href="http://Repair-ServicingError_800f082f">_Repair-ServicingError<em>800f082f.ps1</em></a> __ script.<br />
<br />
<br />
<br /></li>
</ul>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/12.png" alt="image" /></p>

<p>Because f**k you that‚Äôs why!</p>

<h4 id="repair-servicing-error-800f082f"><strong>Repair Servicing Error 800f082f~</strong></h4>

<p>Repair Servicing Error 800f082f~</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/13.png" alt="image" /></p>

<p>Repair operation console output</p>

<h4 id="servicing-result"><strong>Servicing result</strong></h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/14.png" alt="image" /></p>

<p>Work folder</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/15.png" alt="image" /></p>

<p>Serviced image in the SCCM Console</p>

<blockquote>
<p><strong>Notes</strong><br />
Do not service a non-Vanilla Image.<br />
If SCCM servicing fails with error 800f082f, repair the image already imported in SCCM. If you re-import the image in SCCM after repairing the error SCCM will not recognize the already injected updates and will try to re-inject them.</p>
</blockquote>

<h3 id="step-6-applications">Step‚Ää‚Äî‚Ää6 Applications</h3>

<p>I‚Äôm assuming that everyone knows how to package an application so I will just give you some guidelines here.</p>

<h4 id="office-2010"><strong>Office 2010</strong></h4>

<p>The problem with office 2010 is that it has no recent service pack and the installer source has not been updated in ages. You need to drop any updates that you want applied during setup in the instalaton source ‚Äú<em>Updates‚Äù</em> folder. In my case I have about 205 patches there. You need to add a prefix to the file name because they are processed in sequence.</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/16.png" alt="image" /></p>

<p>Office 2010 <strong>‚ÄúUpdates‚Äù</strong> folder</p>

<p><strong>Service Pack 2</strong><br />
Use the following PowerShell commands to extract office 2010 SP2, remove the stuff you don‚Äôt need and add the _‚Äú02SP2<em>‚Äù.</em> prefix to the file names.<br />
<code>## Extract service pack files  
[YourOfficeSP2Folder]\officesp2010-kb2687455-fullfile-x86-en-us.exe /Extract:[YourExtractPathFolder]\Microsoft-Office-2010-SP2-EN-X86 /Q /F</code><code>## Remove Junk  
Remove-Item -Path F:\Temp\Microsoft-Office-2010-SP2-EN-X86\*.xml  
Remove-Item -Path F:\Temp\Microsoft-Office-2010-SP2-EN-X86\*.txt</code><code>## Prefix service pack files  
$Path = &amp;#39;F:\Temp\Updates\*.*&amp;#39;  
Get-Item -Path $Path | Rename-Item -NewName {$_.BaseName.Insert(0,‚Äô02SP2_‚Äô) + $_.Extension }</code></p>

<p>**Other updates<br />
*<em>For the remaining updates you need to install Office 2010 with SP2 and use SCCM to deploy all Office 2010 updates that are not expired or superseded on a test machine. After installing all office updates you can simply get all the downloaded patches from the SCCM cache folder.<br />
Use the following PowerShell commands to consolidate the files from all those folders.<br />
<code>## Set source and destination paths  
$SourcePath = &amp;#39;[YourUpdatesPath]&amp;#39;  
$Destination = &amp;#39;[YourUpdatesDestinationPath]&amp;#39;</code><code>## Create destination path if it does not exist  
If (-not (Test-Path  -Path $Destination)){  
   New-Item $Destination -Type Directory  
}</code><code>## Get all the files  
Get-ChildItem $SourcePath -Recurse |</code><br />
   Where-Object { $<em>.PSIsContainer -eq $False } | ForEach-Object {<br />
   Copy-Item -Path $</em>.Fullname -Destination $Destination -Force<br />
}<code>## Remove Junk  
Remove-Item -Path &amp;#34;$Destination\*.xml&amp;#34;  
Remove-Item -Path &amp;#34;$Destination\*.txt&amp;#34;</code>## Prefix the files<br />
$Path = &#34;$Destination*.</em>&#34;<br />
Get-Item -Path $Path | Rename-Item -NewName {$_.BaseName.Insert(0,‚Äô03PostSP2<em>‚Äô) + $</em>.Extension }`</p>

<p>You can copy now all the files in the Office 2010 <em>‚ÄúUpdates‚Äù</em> folder and create a new app revision to redistribute content.</p>

<h4 id="net-framework-4-7">.Net Framework 4.7</h4>

<p>Unpack and use the .msi because there is a bug in the x86 exe installer and you might get an error.</p>

<h4 id="wmf-5-2"><strong>WMF 5.2</strong></h4>

<p>Just use the .msu and the detection method below<br />
<code>## WMF 5.2 Detection Method  
If (($PSVersionTable.PSVersion | Select-Object -ExpandProperty Major) -eq 5 -and ($PSVersionTable.PSVersion | Select-Object -ExpandProperty Minor) -eq 2){   
   Write-Host &amp;#34;Installed&amp;#34;  
}</code></p>

<h3 id="step-7-build-and-capture">Step‚Ää‚Äî‚Ää7 Build and Capture</h3>

<p>Create a standard Build and Capture Task Sequence</p>

<h4 id="apply-operating-system">Apply Operating System</h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/17.png" alt="image" /></p>

<p>Apply Operating System</p>

<h4 id="install-redistributables">Install Redistributables</h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/18.png" alt="image" /></p>

<p>Install Redistributables</p>

<h4 id="install-core-applications">Install Core Applications</h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/19.png" alt="image" /></p>

<p>Install Core Applications</p>

<h4 id="clean-the-image-before-sysprep">Clean the image before SysPrep</h4>

<p>Use the <a href="https://SCCM.Zone/clean-windowsimage"><strong><em>Clean-ImageBeforeSysprep.ps1</em></strong></a> script from my post.</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/20.png" alt="image" /></p>

<p>Clean the Image before Sysprep</p>

<h4 id="capture-the-reference-image">Capture the Reference Image</h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/21.png" alt="image" /></p>

<p>Capture the Reference Image</p>

<blockquote>
<p><strong>Notes</strong><br />
You can see here that there is no ‚Äú<strong>Install Updates‚Äù</strong> step, because it‚Äôs not needed. My image was missing only 4 updates after this procedure.</p>
</blockquote>

<h3 id="step-8-import-the-captured-image-into-sccm">Step‚Ää‚Äî‚Ää8 Import the Captured Image into SCCM</h3>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/22.png" alt="image" /></p>

<p>Updated (Base) and Captured (OSD) Images</p>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/23.jpeg" alt="image" /></p>

<blockquote>
<p>Use <a href="https://SCCM.Zone/Issues">Github</a> for üêõ reporting, or üåà andü¶Ñ requests</p>
</blockquote>

<h4 id="please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</h4>

<p><img src="/posts/2017-08-31_creating-an-updated-windows-7-osd-image-with-sccm-build-and-capture/images/24.gif" alt="image" /></p>

    </article>
  </div>
  <div class="col-lg-3">
    <div class="sidebar">
  
  <hr />
  <h4>TableOfContents</h4>
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#image-specs">Image specs</a>
<ul>
<li><a href="#injected-in-the-base-image">Injected in the Base Image</a></li>
<li><a href="#installed-during-build-and-capture">Installed during Build and Capture</a></li>
</ul></li>
<li><a href="#important-things-to-remember-when-creating-a-osd-image">Important things to remember when creating a OSD Image</a></li>
<li><a href="#step-1-download-patches">Step 1‚Ää‚Äî‚ÄäDownload Patches</a>
<ul>
<li><a href="#download-ie11-and-prerequisites-https-support-microsoft-com-en-us-help-2847882-prerequisite-updates-for-internet-explorer-11"><a href="https://support.microsoft.com/en-us/help/2847882/prerequisite-updates-for-internet-explorer-11"><strong>Download IE11 and prerequisites</strong></a></a></li>
<li><a href="#download-support-for-future-updates"><strong>Download Support for Future Updates</strong></a></li>
<li><a href="#download-office-2010-sp2"><strong>Download Office 2010 SP2</strong></a></li>
</ul></li>
<li><a href="#step-2-inject-ie11-and-prerequisites">Step 2‚Äî Inject IE11 and prerequisites</a></li>
<li><a href="#step-3-import-the-wim-images">Step 3‚Äî Import the WIM images</a></li>
<li><a href="#step-4-download-the-updates-for-windows-7">Step‚Ää‚Äî‚Ää4 Download the updates for Windows 7</a>
<ul>
<li><a href="#download-updates-in-a-package"><strong>Download updates in a package</strong></a></li>
</ul></li>
<li><a href="#step-5-offline-servicing">Step‚Ää‚Äî‚Ää5 Offline Servicing</a>
<ul>
<li><a href="#problems-you-might-encounter">Problems you might encounter</a></li>
<li><a href="#repair-servicing-error-800f082f"><strong>Repair Servicing Error 800f082f~</strong></a></li>
<li><a href="#servicing-result"><strong>Servicing result</strong></a></li>
</ul></li>
<li><a href="#step-6-applications">Step‚Ää‚Äî‚Ää6 Applications</a>
<ul>
<li><a href="#office-2010"><strong>Office 2010</strong></a></li>
<li><a href="#net-framework-4-7">.Net Framework 4.7</a></li>
<li><a href="#wmf-5-2"><strong>WMF 5.2</strong></a></li>
</ul></li>
<li><a href="#step-7-build-and-capture">Step‚Ää‚Äî‚Ää7 Build and Capture</a>
<ul>
<li><a href="#apply-operating-system">Apply Operating System</a></li>
<li><a href="#install-redistributables">Install Redistributables</a></li>
<li><a href="#install-core-applications">Install Core Applications</a></li>
<li><a href="#clean-the-image-before-sysprep">Clean the image before SysPrep</a></li>
<li><a href="#capture-the-reference-image">Capture the Reference Image</a></li>
</ul></li>
<li><a href="#step-8-import-the-captured-image-into-sccm">Step‚Ää‚Äî‚Ää8 Import the Captured Image into SCCM</a>
<ul>
<li><a href="#please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  <hr />
  <h4><a href="/categories/">Categories</a></h4>
  
  <hr />
  <h4><a href="/tags/">Tags</a></h4>
  
</div>

  </div>
</div>
      <div class="row">
        <footer class="col-lg-12">
          <hr/>
          <span>&copy; SCCM Zone</span>
          <span>&nbsp;&middot;&nbsp;</span>
          <i class="fas fa-bolt"></i>
          <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
        </footer>
      </div>
    </div>
    </main>
    
      
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </body>
</html>

