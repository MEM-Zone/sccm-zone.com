<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="/common/favicon.ico">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/common/site.css">
    
    
    <title>SCCM Zone :: Posts</title>
    <meta property="og:title"       content="SCCM Zone :: Posts" />
    <meta property="og:type"        content="article" />
    
    <meta property="og:url"         content="https://sccm-zone.com/posts/" />
    <meta property="og:description" content="" />
    
    
    
    
    
    
    
    
    
    
    <meta name="twitter:card"       content="summary" />
    
    
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark bg-dark">
      
      <ul class="navbar-nav">
        
        
        
        
      </ul>
    </header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://sccm-zone.com">SCCM Zone</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expand="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar_nav">
        
        <ul class="navbar-nav mr-auto">
          
          
        </ul>
        
        <div class="navbar-nav ml-auto">
          <span class="navbar-text mr-1">share this page via</span>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/share?url=https%3a%2f%2fsccm-zone.com%2fposts%2f&text=Posts" target="_blank"><i class="fab fa-twitter"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsccm-zone.com%2fposts%2f" target="_blank"><i class="fab fa-facebook"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsccm-zone.com%2fposts%2f&title=Posts" target="_blank"><i class="fab fa-linkedin"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://plusone.google.com/_/+1/confirm?url=https%3a%2f%2fsccm-zone.com%2fposts%2f" target="_blank"><i class="fab fa-google-plus"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://b.hatena.ne.jp/entry/https://sccm-zone.com/posts/" target="_blank">b!</a>
            </li>
          </ul>
        </div>
        
      </div>
    </nav>
    <main role="main" class="container-fluid col-lg-10 offset-lg-1">

<div class="row">
  <div class="col-lg-9">
    

    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2017-08-01_cleaning-the-windows-image-before-sysprep-during-an-sccm-bc-task-sequence/">Cleaning the Windows Image before Sysprep during an SCCM B&amp;C Task Sequence</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2017.08.01</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        Cleaning update caches and other junk before Sysprep was always a hurdle‚Ä¶ until now :)
Script release history
I
was creating a Windows image some time ago and wanted to slim down the image before capturing it.
After some research, I found the Action-CleanupBeforeSysprep script by Mikael Nystrom
It‚Äôs a very nice script but it has MDT dependencies and for some reason whenever I see VBScript I get shivers down my spine.
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2017-02-05_add-computers-from-a-file-to-a-sccm-collection-using-powershell-and-system-file-watcher/">Add computers from a file to a SCCM Collection using PowerShell and System File Watcher</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2017.02.05</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        Add computers from a file to a collection just by saving‚Ä¶
Script release history
T
he script will use two CSV files containing mail notification settings and computer names. Collection direct membership rules are removed before adding new computers. Feel free to adjust the templates and script provided bellow to suit your needs.
Script Membership rules configuration file parameters  **DeviceName
Computer name (NetBios Name**).
 **CollectionName
Maintenance windows collection (Collection Name**).
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2017-01-29_setting-sccm-maintenance-windows-using-powershell-and-system-file-watcher/">Setting SCCM Maintenance Windows using PowerShell and System File Watcher</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2017.01.29</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        Don‚Äôt wanna give access to the console just because a client wants to set his own maintenance windows? Here‚Äôs how to do it‚Ä¶
Script release history
T
he script will use two CSV files containing mail and maintenance window configuration. Feel free to adjust the templates and script provided bellow to suit your needs.
Script Maintenance windows configuration file parmeters  **CollectionName
Maintenance windows collection (Collection Name**).
 **Date
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-11-14_disable-push-install-for-a-sccm-collection/">Disable Push Install for a SCCM Collection</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.11.14</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        Have you ever wished that you could disable push install for a specific collection? Welp there is a supported way of doing it‚Ä¶
Script release history
T
urns out there is a registry key you can use for this purpose, it‚Äôs not perfect but it‚Äôs the best option I could find.
The following script is adding computers from a specified device collection to the ExcludeServers registry list and optionally sends a mail report with the help of a csv configuration file.
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-11-01_its-probably-because-you-did-not-set-the-powershell-execution-policy-to-bypass-in-client-settings/">It‚Äôs probably because you did not set the PowerShell execution policy to Bypass in Client Settings‚Ä¶</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.11.01</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        It‚Äôs probably because you did not set the PowerShell execution policy to Bypass in Client Settings, see image below.
Set PowerShell execution policy to Bypass
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-05-19_powershell-error-handling-for-multiple-commands/">Powershell Error Handling for multiple commands</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.05.19</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        What if I told you‚Ä¶
A
friend of mine asked me how to do error handling in powershell for multiple commands. There is no simple answer to this as there are multiple ways of doing it in powershell. In the examples below I need to delete a powershell module that is located in one of the paths defined in the OSDScriptsPath variable. This are just and examples and should be treated as such.
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-03-25_fix-sysprep-error-on-windows-2008-r2-or-windows-7-after-installing-windows-management-framework-5.0/">Fix Sysprep Error on Windows 2008 R2 or Windows 7 after installing Windows Management Framework 5.0</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.03.25</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        I always hate it when sysprep fails but this time it had a happy ending‚Ä¶
Problem  Install Windows Management Framework 5.0 (Contains PowerShell 5.0)
on Windows 2008 R2 or Windows 7.
 Run sysprep.
 Sysprep fails with:Sysprep_Generalize_MiStreamProv: RegDeleteValue for target uri failed with error = 2[gle=0x00000002] Sysprep_Generalize_MiStreamProv: RegDeleteValue for full payload time failed with error = 2[gle=0x00000002]
  Solution  Add the following key to registry:[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\StreamProvider] ‚ÄúLastFullPayloadTime‚Äù=dword:00000000
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-02-29_sccm-common-push-install-errors/">SCCM Common Push Install Errors</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.02.29</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        I‚Äôve gathered a list of common errors, it may help you find a root cause when troubleshooting SCCM Push Install.
Here is the .pdf CM Push Install Errors.pdf
Here is the .xlsx CM Push Install Errors.xlsx
Here is the .png When the Network Admin tells you that all required ports are open and you know they‚Äôre not‚Ä¶
 Use Github for üêõ reporting, or üåà andü¶Ñ requests
 üôè Please subscribe or clap for this article, it makes a difference!
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-02-25_set-sccm-maintenance-windows-based-on-patch-tuesday-with-powershell/">Set SCCM Maintenance Windows based on Patch Tuesday with PowerShell</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.02.25</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        This is a well known limitation SCCM but it can be addressed with non-recurrent Maintenance Windows.
Script release history
Script Configuration file parameters The script is using a ‚Äúconfiguration‚Äù CSV where you can specify the script parameters.
 CollectionName Specifies the collection name for which to set maintenance windows.
 Year Specifies the maintenance window year.
 Month
Specifies the maintenance window month.
 OffsetWeeks Specifies the maintenance window offset number of weeks after patch Tuesday.
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    
    <article>
      <div class="row">
        <h3><a href="/posts/2016-02-23_get-active-directory-computer-information-from-all-domains-in-multiple-forests/">Get Active Directory Computer information from all domains in multiple forests</a></h3>
      </div>
      <div class="row">
        <span class="ml-1">Created At: 2016.02.23</span>
        <span class="ml-1">Updated At: 2019.08.23</span>
        
      </div>
      <div class="row">
        If you have a multiple forest structure and need to collect computer information from all domains in those forests you might find this script useful.
Script release history
T
he following script takes a list of forests as input via GUI. It then parses all domains in these forests collecting Host Name, Operating System and Domain information for all non disabled computer accounts. The collected information will then be exported to a CSV file.
      </div>
      <div class="row">
        
      </div>
    </article>
    <hr/>
    
    
    

<nav aria-label="page navidation">
  <ul class="pagination pagination-sm">
    <li class="page-item">
      <a class="page-link" href="/posts/page/2/">&lt</a>
    </li>
    
    <li class="page-item">
      <a class="page-link" href="/posts/">1</a>
    </li>
    
    <li class="page-item">
      <a class="page-link" href="/posts/page/2/">2</a>
    </li>
    
    <li class="page-item active">
      <a class="page-link" href="/posts/page/3/">3<span class="sr-only"></span></a>
    </li>
    
    <li class="page-item">
      <a class="page-link" href="/posts/page/4/">4</a>
    </li>
    
    <li class="page-item">
      <a class="page-link" href="/posts/page/4/">&gt</a>
    </li>
  </ul>
</nav>


  </div>

  <div class="col-lg-3">
    <div class="sidebar">
  
  <hr />
  <h4>TableOfContents</h4>
  
  <hr />
  <h4><a href="/categories/">Categories</a></h4>
  
  <hr />
  <h4><a href="/tags/">Tags</a></h4>
  
</div>

  </div>
</div>
      <div class="row">
        <footer class="col-lg-12">
          <hr/>
          <span>&copy; SCCM Zone</span>
          <span>&nbsp;&middot;&nbsp;</span>
          <i class="fas fa-bolt"></i>
          <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
        </footer>
      </div>
    </div>
    </main>
    
      
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </body>
</html>

