<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="/common/favicon.ico">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="/common/site.css">
    
    
    <title>SCCM Zone :: Disable Push Install for a SCCM Collection</title>
    <meta property="og:title"       content="SCCM Zone :: Disable Push Install for a SCCM Collection" />
    <meta property="og:type"        content="article" />
    
    <meta property="og:url"         content="https://sccm-zone.com/posts/2016-11-14_disable-push-install-for-a-sccm-collection/" />
    <meta property="og:description" content="" />
    
    
    
    
    
    
    
    
    
    
    <meta name="twitter:card"       content="summary" />
    
    
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark bg-dark">
      
      <ul class="navbar-nav">
        
        
        
        
      </ul>
    </header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://sccm-zone.com">SCCM Zone</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_nav" aria-controls="navbar_nav" aria-expand="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar_nav">
        
        <ul class="navbar-nav mr-auto">
          
          
          
          <li class="nav-item">
            <span class="nav-link disabled">Created At: 2016.11.14</span>
          </li>
          <li class="nav-item">
            <span class="nav-link disabled">Updated At: 2019.08.23</span>
          </li>
          
        </ul>
        
        <div class="navbar-nav ml-auto">
          <span class="navbar-text mr-1">share this page via</span>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="https://twitter.com/share?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-11-14_disable-push-install-for-a-sccm-collection%2f&text=Disable%20Push%20Install%20for%20a%20SCCM%20Collection" target="_blank"><i class="fab fa-twitter"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-11-14_disable-push-install-for-a-sccm-collection%2f" target="_blank"><i class="fab fa-facebook"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-11-14_disable-push-install-for-a-sccm-collection%2f&title=Disable%20Push%20Install%20for%20a%20SCCM%20Collection" target="_blank"><i class="fab fa-linkedin"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://plusone.google.com/_/+1/confirm?url=https%3a%2f%2fsccm-zone.com%2fposts%2f2016-11-14_disable-push-install-for-a-sccm-collection%2f" target="_blank"><i class="fab fa-google-plus"></i></a></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://b.hatena.ne.jp/entry/https://sccm-zone.com/posts/2016-11-14_disable-push-install-for-a-sccm-collection/" target="_blank">b!</a>
            </li>
          </ul>
        </div>
        
      </div>
    </nav>
    <main role="main" class="container-fluid col-lg-10 offset-lg-1">

<div class="row">
  <div class="col-lg-9">
    <article>
      <div class="row">
        <h1>Disable Push Install for a SCCM Collection</h1>
      </div>
      

<p><img src="/posts/2016-11-14_disable-push-install-for-a-sccm-collection/images/1.jpeg" alt="image" /></p>

<p>Have you ever wished that you could disable push install for a specific collection? Welp there is a supported way of doing it‚Ä¶</p>

<p><a href="https://SCCM.Zone/disable-cmdevicecollectionpush-changelog"><strong><em>Script release history</em></strong></a></p>

<p>T<br />
urns out there is a <a href="https://technet.microsoft.com/en-us/library/bb693996.aspx"><strong><em>registry key</em></strong></a> you can use for this purpose, it‚Äôs not perfect but it‚Äôs the best option I could find.</p>

<p>The following script is adding computers from a specified device collection to the <strong><em>ExcludeServers</em></strong> registry list and optionally sends a mail report with the help of a csv <strong><em>configuration</em></strong> file.</p>

<p>You can run this script on a daily basis using the task scheduler, and deploy an app that uninstalls both SCEP and SCCM client on this collection.<br />
&gt; <strong>Notes</strong><br />
&gt; When you add a computer to the <strong>ExcludeServers</strong> list, it is flagged with a status of installed, which prevents the client from reinstalling by using the automatic site-wide client push installation method. If you later remove the computer from the exclude list, this flag remains. To change this status to uninstalled, you must run the clear install flag task.<br />
&gt; If you need to remove a computer from the <strong>ExcludeServers</strong> registry list you must <strong>remove it manually</strong> as the value is never replaced, only merged with the collection device members.</p>

<h3 id="script">Script</h3>

<h4 id="script-parameters">Script parameters</h4>

<ul>
<li><strong>CMSiteServer</strong><br />
<em>Specifies the NetBios name of the SCCM site server.</em><br /></li>
<li>**CMCollection<br />
**<em>Specifies the collection name to exclude from push install.</em><br /></li>
<li>**DeleteAllCollectionMembers<br />
**<em>Optional switch used to delete all collection device members and their discovery data using CIM (blazing fast :P).</em><br />
<br /></li>
</ul>

<h4 id="script-configuration-file-parameters">Script configuration file parameters</h4>

<ul>
<li>**SendMail<br />
<strong><em>Specifies to send mail after the script is run (</em></strong><em>Yes/No</em>**<em>).</em><br /></li>
<li>**From<br />
<strong><em>Specifies mail sender to impersonate (</em></strong><em>SCCM &lt;noreply@test.com&gt;</em>**<em>).</em><br /></li>
<li>**To<br />
<strong><em>Specifies send mail to address (&lt;</em></strong><em>sccm-team@test.com&gt;</em>**<em>).</em><br /></li>
<li>**CC<br />
<strong><em>Specifies carbon copy address (&lt;</em></strong><em>No&gt;/&lt;test@test.com&gt;</em>**<em>).</em><br /></li>
<li>**SMTPServer<br />
<strong><em>Specifies the SMTP enabled server FQDN (&lt;</em></strong><em>mail.test.com&gt;</em>**<em>).</em><br /></li>
<li>**SMTPPort<br />
<strong><em>Specifies the SMTP server port (&lt;</em></strong><em>25&gt;</em>**<em>)</em>.<br />
<br /></li>
</ul>

<p>Disable SCCM push install for a specified device collection, using CIM</p>

<h4 id="script-configuration-file-template">Script configuration file template</h4>

<p><img src="/posts/2016-11-14_disable-push-install-for-a-sccm-collection/images/2.jpeg" alt="image" /></p>

<blockquote>
<p>Use <a href="https://SCCM.Zone/Issues">Github</a> for üêõ reporting, or üåà andü¶Ñ requests</p>
</blockquote>

<h4 id="please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</h4>

<p><img src="/posts/2016-11-14_disable-push-install-for-a-sccm-collection/images/3.gif" alt="image" /></p>

    </article>
  </div>
  <div class="col-lg-3">
    <div class="sidebar">
  
  <hr />
  <h4>TableOfContents</h4>
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#script">Script</a>
<ul>
<li><a href="#script-parameters">Script parameters</a></li>
<li><a href="#script-configuration-file-parameters">Script configuration file parameters</a></li>
<li><a href="#script-configuration-file-template">Script configuration file template</a></li>
<li><a href="#please-subscribe-or-clap-for-this-article-it-makes-a-difference">üôè Please subscribe or clap for this article, it makes a difference! üôè</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  <hr />
  <h4><a href="/categories/">Categories</a></h4>
  
  <hr />
  <h4><a href="/tags/">Tags</a></h4>
  
</div>

  </div>
</div>
      <div class="row">
        <footer class="col-lg-12">
          <hr/>
          <span>&copy; SCCM Zone</span>
          <span>&nbsp;&middot;&nbsp;</span>
          <i class="fas fa-bolt"></i>
          <span>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a></span>
        </footer>
      </div>
    </div>
    </main>
    
      
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js" integrity="sha384-SlE991lGASHoBfWbelyBPLsUlwY1GwNDJo3jSJO04KZ33K2bwfV9YBauFfnzvynJ" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </body>
</html>

